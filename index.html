<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Valentine‚Äôs</title>

<style>
:root{
--bg1:#06060a;
--bg2:#0a0a12;
--text:#ffffff;
--muted:rgba(255,255,255,0.78);
--btn:rgba(255,255,255,0.14);
--btnHover:rgba(255,255,255,0.22);
--accent1:#ff4d6d;
--accent2:#ff8fa3;
--shadow:rgba(0,0,0,0.55);
}
*{ box-sizing:border-box; }

html,body{
height:100%;
margin:0;
background: radial-gradient(1200px 700px at 15% 10%, rgba(255,77,109,0.14), transparent 55%),
radial-gradient(900px 520px at 85% 30%, rgba(255,143,163,0.10), transparent 60%),
radial-gradient(700px 500px at 50% 92%, rgba(255,255,255,0.06), transparent 60%),
linear-gradient(180deg, var(--bg1), var(--bg2));
color:var(--text);
font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
overflow:hidden;
}

.sparkles{
position:fixed; inset:0;
pointer-events:none;
opacity:0.18;
background-image:
radial-gradient(circle at 18% 22%, rgba(255,255,255,0.08) 0 1px, transparent 2px),
radial-gradient(circle at 72% 18%, rgba(255,255,255,0.06) 0 1px, transparent 2px),
radial-gradient(circle at 44% 78%, rgba(255,255,255,0.05) 0 1px, transparent 2px),
radial-gradient(circle at 82% 70%, rgba(255,255,255,0.05) 0 1px, transparent 2px);
filter: blur(0.2px);
}

/* FULL SCREEN cinema */
.screen{ position:fixed; inset:0; overflow:hidden; }

/* letterbox bars */
.letterbox{ position:absolute; inset:0; pointer-events:none; z-index:5; }
.bar{
position:absolute; left:0; right:0;
height:0%;
background: rgba(0,0,0,0.94);
transition: height 1100ms cubic-bezier(.2,.9,.2,1);
}
.bar.top{ top:0; }
.bar.bottom{ bottom:0; }
.screen.tight .bar{ height:40%; }
.screen.open .bar{ height:10%; }

/* title cards overlay */
.titlecard{
position:absolute; inset:0;
z-index:6;
display:flex;
align-items:center;
justify-content:center;
padding:28px;
text-align:center;
opacity:0;
transform: translateY(10px);
transition: opacity 700ms ease, transform 700ms ease;
pointer-events:none;
}
.titlecard.show{ opacity:1; transform: translateY(0); }
.cardText{
font-weight:950;
letter-spacing:2.2px;
text-transform:uppercase;
color: rgba(255,255,255,0.90);
font-size: clamp(18px, 3.2vw, 44px);
line-height:1.25;
text-shadow: 0 10px 40px rgba(0,0,0,0.65);
}

/* app content */
.wrap{
position:absolute; inset:0;
z-index:2;
display:flex;
align-items:center;
justify-content:center;
padding:26px;
text-align:center;
opacity:0;
transform: translateY(8px);
transition: opacity 700ms ease, transform 700ms ease;
}
.wrap.visible{ opacity:1; transform: translateY(0); }

.card{
width:min(820px, 92vw);
padding:28px 20px 22px;
border-radius:22px;
background: rgba(0,0,0,0.35);
border: 1px solid rgba(255,255,255,0.14);
box-shadow: 0 18px 60px var(--shadow);
backdrop-filter: blur(8px);
}
.icons{
font-size:62px;
letter-spacing:10px;
opacity:0.95;
margin-bottom:16px;
user-select:none;
}
.title{
font-weight:950;
text-transform:uppercase;
letter-spacing:2px;
margin:0 0 10px;
font-size: clamp(30px, 5.2vw, 58px);
line-height:1.05;
}
.subtitle{
margin:0 0 18px;
color:var(--muted);
font-size: clamp(14px, 2.2vw, 18px);
line-height:1.5;
}
.stage{
margin-top:14px;
display:flex;
flex-direction:column;
align-items:center;
gap:14px;
}
.q{
font-size: clamp(18px, 2.8vw, 26px);
font-weight:850;
margin:6px 0;
letter-spacing:0.2px;
}
.btns{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:12px;
position:relative;
}
button{
border:0;
cursor:pointer;
padding:12px 14px;
border-radius:14px;
background: var(--btn);
color: var(--text);
font-weight:750;
font-size:16px;
transition: transform .08s ease, background .25s ease, filter .2s ease;
backdrop-filter: blur(6px);
-webkit-tap-highlight-color: transparent;
}
button:hover{ background: var(--btnHover); }
button:active{ transform: scale(0.98); }

.primary{
background: linear-gradient(135deg, var(--accent1), var(--accent2));
color:#14060a;
font-weight:900;
}
.primary:hover{ filter: brightness(1.05); }

#noBtn{ position:relative; opacity:0.88; font-size:14px; }

.gif{
width:min(560px,92vw);
margin:16px auto 0;
border-radius:18px;
overflow:hidden;
border:1px solid rgba(255,255,255,0.14);
background: rgba(0,0,0,0.35);
box-shadow: 0 18px 60px rgba(0,0,0,0.55);
}
.gif img{ width:100%; display:block; }

/* ---------- PUZZLE (added) ---------- */
.puzzleWrap{
display:flex;
flex-direction:column;
align-items:center;
gap:12px;
}
.puzzleGrid{
width:min(420px, 82vw);
aspect-ratio: 1 / 1;
display:grid;
grid-template-columns: repeat(3, 1fr);
gap:8px;
padding:10px;
border-radius:18px;
background: rgba(255,255,255,0.06);
border:1px solid rgba(255,255,255,0.12);
box-shadow: 0 18px 60px rgba(0,0,0,0.45);
}
.tile{
border-radius:14px;
border:1px solid rgba(255,255,255,0.14);
background: rgba(0,0,0,0.35);
background-repeat:no-repeat;
background-size: 300% 300%;
cursor:pointer;
transition: transform .08s ease, filter .2s ease, outline .2s ease;
}
.tile:active{ transform: scale(0.99); }
.tile.sel{
outline: 3px solid rgba(255,143,163,0.55);
filter: brightness(1.06);
}
.status{
color: rgba(255,255,255,0.85);
font-weight:850;
letter-spacing:0.8px;
text-transform:uppercase;
font-size: 13px;
}
.hidden{ display:none; }

/* ---------- COUNTDOWN (added) ---------- */
.countWrap{
display:flex;
flex-direction:column;
align-items:center;
gap:14px;
}
.filmFrame{
width:min(520px, 86vw);
aspect-ratio: 16 / 9;
border-radius:18px;
position:relative;
overflow:hidden;
background:
linear-gradient(90deg, rgba(0,0,0,0.12) 50%, rgba(255,255,255,0.03) 50%),
linear-gradient(0deg, rgba(0,0,0,0.10) 50%, rgba(255,255,255,0.03) 50%);
border:1px solid rgba(255,255,255,0.16);
box-shadow: 0 18px 60px rgba(0,0,0,0.55);
}
.filmFrame::before{
content:"";
position:absolute; inset:0;
background:
radial-gradient(circle at 30% 35%, rgba(255,255,255,0.08), transparent 45%),
radial-gradient(circle at 70% 60%, rgba(255,255,255,0.06), transparent 50%);
mix-blend-mode: screen;
opacity:0.35;
pointer-events:none;
}
.crossV, .crossH{
position:absolute;
background: rgba(0,0,0,0.55);
opacity:0.55;
}
.crossV{ width:2px; top:0; bottom:0; left:50%; transform:translateX(-1px); }
.crossH{ height:2px; left:0; right:0; top:50%; transform:translateY(-1px); }

.ring{
position:absolute; inset:10%;
border-radius:50%;
border: 3px solid rgba(255,255,255,0.55);
opacity:0.85;
}
.ring2{
position:absolute; inset:13%;
border-radius:50%;
border: 2px solid rgba(255,255,255,0.35);
opacity:0.85;
}
.sweep{
position:absolute;
left:50%; top:50%;
width:2px;
height:48%;
background: rgba(0,0,0,0.75);
transform-origin: bottom center;
animation: sweep 1s linear infinite;
}
@keyframes sweep{
from{ transform: translate(-50%, -100%) rotate(0deg); }
to{ transform: translate(-50%, -100%) rotate(360deg); }
}
.countNum{
position:absolute;
inset:0;
display:flex;
align-items:center;
justify-content:center;
font-weight:950;
font-size: clamp(64px, 14vw, 140px);
color: rgba(0,0,0,0.78);
text-shadow:
0 2px 0 rgba(255,255,255,0.35),
0 18px 60px rgba(0,0,0,0.55);
letter-spacing:2px;
}
.countLabel{
font-weight:950;
letter-spacing:2px;
text-transform:uppercase;
opacity:0.9;
}
</style>
</head>

<body>
<div class="sparkles"></div>

<div class="screen" id="screen">
<div class="letterbox">
<div class="bar top"></div>
<div class="bar bottom"></div>
</div>

<div class="titlecard" id="titlecard">
<div class="cardText" id="cardText"></div>
</div>

<main class="wrap" id="app"></main>
</div>

<script>
const screen = document.getElementById('screen');
const app = document.getElementById('app');
const titlecard = document.getElementById('titlecard');
const cardText = document.getElementById('cardText');

const ROMCOM_GIF_URL = "https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExdTN6ejdsY2I5dnNtejJibDFjNGxjenIycnFoYzR3aGJ4MXhuZGJtciZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/QeAqQ2k1shJwoBNggF/giphy.gif";

/* ‚úÖ paste your image URL for the puzzle here */
const PUZZLE_IMG_URL = "https://i.ytimg.com/vi/7rspQR7rhf0/hq720.jpg?sqp=-oaymwEhCK4FEIIDSFryq4qpAxMIARUAAAAAGAElAADIQj0AgKJD&rs=AOn4CLD7nbgXEv1oadfkWqYeAnabI0JZLA";

/* =========================
‚úÖ INTRO (this was missing)
========================= */
function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }

const cards = [
"INDIE SREERAM PICTURES PRESENTS",
"JAY NAGJEE",
"IN AN INDIE SREERAM PRODUCTION",
"OF AN INDIE SREERAM FILM",
"A VALENTINE‚ÄôS DAY"
];

const FADE_IN_MS = 700;
const HOLD_MS = 1600;
const FADE_OUT_MS = 700;

async function showCard(text){
cardText.textContent = text;
titlecard.classList.add('show');
await sleep(FADE_IN_MS);
await sleep(HOLD_MS);
titlecard.classList.remove('show');
await sleep(FADE_OUT_MS);
}

function hero(){
app.innerHTML = `
<div class="card">
<div class="icons">üçø üíò</div>
<h1 class="title">A Valentine‚Äôs Day</h1>
<p class="subtitle">
You have been invited to a private screening.<br/>
</p>
<div class="stage">
<button class="primary" onclick="q1()">RSVP</button>
</div>
</div>
`;
}

/* =========================
‚úÖ PUZZLE
========================= */
function q1(){
app.innerHTML = `
<div class="card">
<div class="icons">üß© üé¨</div>
<h1 class="title">Rebuild the Scene</h1>
<p class="subtitle">
Slide the tiles to restore the movie scene.<br/>
You only need about <b>5 moves</b> üòâ
</p>

<div class="puzzleWrap">
<div class="status" id="moveStatus">Moves left: 8</div>
<div class="puzzleGrid" id="puzzleGrid"></div>

<div class="btns">
<button class="primary hidden" id="startShowtimeBtn" onclick="q2()">Start Showtime</button>
</div>

<p class="subtitle" style="margin-top:4px; font-size:14px; opacity:0.85;">
Tap a tile next to the empty space to move it.
</p>
</div>
</div>
`;

const grid = document.getElementById('puzzleGrid');
const moveStatus = document.getElementById('moveStatus');
const startShowtimeBtn = document.getElementById('startShowtimeBtn');

const EMPTY = 8; // bottom-right is empty tile
const MAX_MOVES = 8;
let movesUsed = 0;

// solved order
let order = [0,1,2,3,4,5,6,7,8];

/* ---- LIGHT SCRAMBLE (5 legal moves only) ---- */
const SCRAMBLE_MOVES = 5;
let lastEmpty = null;

for(let i=0;i<SCRAMBLE_MOVES;i++){
const empty = order.indexOf(EMPTY);

const candidates = [];
if(empty % 3 !== 0) candidates.push(empty-1);
if(empty % 3 !== 2) candidates.push(empty+1);
if(empty-3 >= 0) candidates.push(empty-3);
if(empty+3 < 9) candidates.push(empty+3);

const filtered = candidates.filter(p => p !== lastEmpty);
const pool = filtered.length ? filtered : candidates;
const moveFrom = pool[Math.floor(Math.random() * pool.length)];

lastEmpty = empty;
[order[moveFrom], order[empty]] = [order[empty], order[moveFrom]];
}
/* --------------------------------------------- */

function isSolved(){
for(let i=0;i<9;i++){
if(order[i] !== i) return false;
}
return true;
}

function bgForPiece(pieceIndex){
if(pieceIndex === EMPTY) return "background:none;";

const x = pieceIndex % 3;
const y = Math.floor(pieceIndex / 3);

return `
background-image: url('${PUZZLE_IMG_URL}');
background-position: ${x*50}% ${y*50}%;
background-size: 300% 300%;
`;
}

function render(){
grid.innerHTML = "";

order.forEach((piece,pos)=>{
const tile = document.createElement("div");
tile.className = "tile";
tile.style.cssText = bgForPiece(piece);

if(piece === EMPTY){
tile.style.background = "rgba(0,0,0,0.4)";
tile.style.border = "1px dashed rgba(255,255,255,0.25)";
tile.style.cursor = "default";
} else {
tile.addEventListener("click", ()=>{
if(movesUsed >= MAX_MOVES) return;

const empty = order.indexOf(EMPTY);
const valid =
(pos === empty-1 && empty%3!==0) ||
(pos === empty+1 && empty%3!==2) ||
(pos === empty-3) ||
(pos === empty+3);

if(!valid) return;

[order[pos], order[empty]] = [order[empty], order[pos]];
movesUsed++;

moveStatus.textContent = "Moves left: " + (MAX_MOVES - movesUsed);
render();

if(isSolved()){
moveStatus.textContent = "Scene restored üé¨‚ú®";
startShowtimeBtn.classList.remove("hidden");
}
});
}

grid.appendChild(tile);
});
}

render();
}

/* =========================
‚úÖ COUNTDOWN
========================= */
function q2(){
app.innerHTML = `
<div class="card">
<div class="icons">üéûÔ∏è ‚è≥</div>
<h1 class="title">Showtime</h1>
<p class="subtitle"><span class="countLabel">Showtime begins in</span></p>

<div class="countWrap">
<div class="filmFrame" aria-label="Screening countdown">
<div class="crossV"></div>
<div class="crossH"></div>
<div class="ring"></div>
<div class="ring2"></div>
<div class="sweep"></div>
<div class="countNum" id="countNum">5</div>
</div>

<p class="subtitle" style="margin-top:4px; font-size:14px; opacity:0.85;">
Get ready üçø
</p>
</div>
</div>
`;

const el = document.getElementById('countNum');
let n = 5;

const tick = () => {
el.textContent = n;
n--;
if(n === 0){
setTimeout(() => { finalQ(); }, 650);
return;
}
setTimeout(tick, 1000);
};

tick();
}

// ‚úÖ Final valentine question (with dodging "no")
function finalQ(){
app.innerHTML = `
<div class="card">
<div class="icons">üé¨ üíñ</div>
<h1 class="title">Final Cut</h1>
<div class="stage">
<div class="q">Jay, will you be my Valentine?</div>
<div class="btns" id="finalBtns">
<button class="primary" onclick="yes()">Yes, I would love to</button>
<button id="noBtn">No</button>
</div>
</div>
</div>
`;

const noBtn = document.getElementById('noBtn');
const dodge = () => {
const maxX = 180, maxY = 70;
const x = (Math.random() * (maxX * 2)) - maxX;
const y = (Math.random() * (maxY * 2)) - maxY;
noBtn.style.transform = `translate(${x}px, ${y}px)`;
};
noBtn.addEventListener('mouseenter', dodge);
noBtn.addEventListener('mouseover', dodge);
noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); dodge(); }, {passive:false});
noBtn.addEventListener('click', (e) => { e.preventDefault(); dodge(); });
}

function yes(){
const gifBlock = (ROMCOM_GIF_URL && !ROMCOM_GIF_URL.includes("PASTE_"))
? `<div class="gif"><img src="${ROMCOM_GIF_URL}" alt="romcom gif"></div>`
: "";

app.innerHTML = `
<div class="card">
<div class="icons">‚úÖ üíò</div>
<h1 class="title">INVITATION CONFIRMED</h1>
<p class="subtitle" style="font-weight:900; letter-spacing:2px; text-transform:uppercase;">
You are officially my <span style="color:var(--accent2)">VALENTINE</span> üíñ
</p>
${gifBlock}
<p class="subtitle" style="margin-top:14px; color:rgba(255,255,255,0.90); font-size:18px;">
Jay, I love you baby. You are my best friend and the most amazing human I know and there is nobody else I‚Äôd want to do life with.
</p>
</div>
`;
}

/* =========================
‚úÖ INTRO RUN
========================= */
async function runIntro(){
screen.classList.remove('tight', 'open');

await sleep(250);
screen.classList.add('tight');
await sleep(1250);

for (let i = 0; i < cards.length; i++){
await showCard(cards[i]);
}

screen.classList.remove('tight');
screen.classList.add('open');

await sleep(800);
hero();
app.classList.add('visible');
}

runIntro();
</script>
</body>
</html>
